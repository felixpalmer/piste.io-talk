<!DOCTYPE HTML>
<html lang="en">
<head>
	<title>How to build a mountain in your spare time</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=792, user-scalable=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<link rel="stylesheet" href="shower/themes/ribbon/styles/screen.css">
    <style>
        #Cover h2 {
            margin:30px 0 0;
            color:#FFF;
            text-align:center;
            font-size:70px;
            }
        #Cover p {
            margin:10px 0 0;
            text-align:center;
            color:#FFF;
            font-style:italic;
            font-size:20px;
            }
        #Cover p a {
            color:#FFF;
        }
        .cover img {
            width: 100%;
        }
        .cover {
            color:#FFF;
        }
        .cover h2 {
            margin:-30px 0 20px;
            color:#FFF;
            font-size:70px;
        }
        .dark {
            color: #000 !important;
        }
        img.right {
            height:100%;
            top:0;
            left:auto;
            right:0;
            position:absolute;
        }
        .tiny {
              position: absolute;
              right: 2%;
              bottom: 3%;
              height: 200px;
              width: 200px;
              box-shadow: 2px 2px 10px black;
          }

          .tiny-top {
              position: absolute;
              right: 2%;
              top: 3%;
              height: 200px;
              width: 200px;
              box-shadow: 2px 2px 10px black;
          }
          .small {
              position: absolute;
              right: 2%;
              bottom: 3%;
              height: 40%;
              width: 40%;
              box-shadow: 2px 2px 10px black;
          }

          .small-top {
              position: absolute;
              right: 2%;
              top: 3%;
              height: 40%;
              width: 40%;
              box-shadow: 2px 2px 10px black;
          }

          .medium {
              position: absolute;
              right: 2%;
              bottom: 3%;
              height: 50%;
              width: 96%;
              box-shadow: 2px 2px 10px black;
          }

          .bottom {
              position: absolute;
              left: 0%;
              top: 65%;
              width: 100%;
          }

          .tiny:hover, .tiny-top:hover, .small-top:hover, .small:hover, .medium:hover {
              position: absolute;
              right: 2%;
              bottom: 3%;
              height: 94%;
              width: 96%;
          }
          #Data h2, #Data li {
              color:#FFF;
          }
          #Data p.note {
              margin:0;
              font-size:14pt;
          }
        
    </style>
</head>
<body class="list">
	<header class="caption">
		<h1>How to build a mountain in your spare time</h1>
		<p>Felix Palmer | @pheeelicks | www.pheelicks.com</p>
	</header>
	<section class="slide cover" id="Cover"><div>
		<h2>How to build a mountain in your spare time</h2>
		<p>Felix Palmer | @pheeelicks | www.pheelicks.com</p>
		<img src="pictures/piste-sunrise.jpg" alt="">
        <p>Slides: <a href="http://felixpalmer.github.io/piste.io-talk">felixpalmer.github.io/piste.io-talk</a></p>
	</div></section>
	<section class="slide cover"><div>
		<h2>Who am I?</h2>
		<img src="pictures/la-plagne.jpg" alt="">
	</div></section>
	<section class="slide cover"><div>
		<h2>Goals</h2>
        <ul>
            <li>Online learning</li>
            <li>Technical writing</li>
            <li>Speaking at conferences</li>
            <li>Meaningful side project</li>
        </ul>
		<img src="pictures/praha.jpg" alt="">
	</div></section>
	<section class="slide cover"><div>
		<h2>Project : piste.io</h2>
		<img src="pictures/matterhorn2.jpg" alt="">
	</div></section>
	<section class="slide"><div>
		<h2>Overview</h2>
        <ul>
            <li>From trains to mountains</li>
            <li>Building your own tools</li>
            <li>Blogging to learn and solve problems</li>
            <li>Drawing inspiration (shadertoy)</li>
        </ul>
	</div></section>
    <section class="slide cover"><div>
        <h2>Starting with trains</h2>
        <ul>
            <li>Mine data from API</li>
            <li>Create 3D scene to explore</li>
            <li>No underlying geographic data</li>
        </ul>
		<img src="pictures/vlaky1b.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>Tools</h2>
        <ul>
            <li>Frontend</li>
            <ul>
                <li>THREE.js, JavaScript</li>
            </ul>
            <li>Data processing</li>
            <ul>
                <li>Python</li>
            </ul>
        </ul>
    </div></section>
    <section class="slide shout cover"><div>
        <h2 class="dark">DEMO</h2>
		<img src="pictures/demo1.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>Geo-data</h2>
        <ul>
            <li>Both raster...</li>
            <ul>
                <li>Satellite imagery</li>
                <li>Elevation data</li>
            </ul>
            <li>...and vector</li>
            <ul>
                <li>Town boundaries</li>
                <li>Rivers, roads, etc</li>
            </ul>
        </ul>
		<img class="small-top" src="pictures/nat_earth.jpg" alt="">
        <p class="note">Lots of nice global data sets: <a href="http://www.naturalearthdata.com/">http://www.naturalearthdata.com/</a></p>
    </div></section>
    <section class="slide"><div>
        <h2>Tools</h2>
        <ul>
            <li>Frontend</li>
            <ul>
                <li>THREE.js, JavaScript</li>
            </ul>
            <li>Data processing</li>
            <ul>
                <li>Python, <strong>QGIS, GDAL</strong></li>
            </ul>
        </ul>
    </div></section>
    <section class="slide"><div>
        <h2>Loading in data</h2>
        <code>var hMap = [[14.298, 51.050, 475.0], [14.293, 51.041, 391.0]....];</code></br>
        <code>for ( vertex in vertices ) {</code></br>
        <code>&nbsp;&nbsp;var h = hMap[row][col];</code></br>
        <code>&nbsp;&nbsp;vertex.z += h;</code></br>
    </div></section>
    <section class="slide cover shout"><div>
        <h2>DEMO</h2>
		<img src="pictures/vlaky2.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>Abstracting</h2>
        <ul>
            <li>Idea to create library</li>
            <li>Drawing region in 3D, quite a lot of effort</li>
            <li>Abstract from user</li>
        </ul>
        <code>var usa = new Terra( 'usa' )</code>
		<img class="small-top" src="pictures/terra1.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>JavaScript is pretty slow</h2>
        <ul>
            <li>JavaScript just too slow for processing huge data</li>
            <li>GPU will render anyway, so why not process there too?</li>
            <li>No longer thinking in JSON, but textures</li>
        </ul>
		<img class="small" src="pictures/srtm.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>Modifying geometry on the GPU</h2>
        <code>vec3 p = position;</code></br>
        <code>vec2 textureCoord = positionToTexture( position );</code></br>
        <code>p.z = texture2D( uElevation, textureCoord );</code></br>
        <code>gl_Position = projectionMatrix * viewMatrix *</code></br>
        <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vec4( p, 1.0 );</code></br>
    </div></section>
    <section class="slide shout cover"><div>
        <h2>DEMO</h2>
		<img src="pictures/demo2.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>Push as much onto GPU</h2>
        <ul>
            <li>General approach: push as much as possible onto GPU</li>
            <li>CPU speeds pretty much stalled, GPUs improving all the time</li>
            <li>Bet on a future where the GPU is your most powerful processor</li>
        </ul>
		<img class="small" src="pictures/srtm.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>Require.js &amp; THREE.js</h2>
        <ul>
            <li>One big <code>JS</code> file just not scalable (surprise!)</li>
            <li>Decided to go with Require.js to modularize code</li>
            <li>Created example project for easy prototyping</li>
        </ul>
        <p><a href="https://github.com/felixpalmer/amd-three.js">https://github.com/felixpalmer/amd-three.js</a></p>
    </div></section>
	<section class="slide"><div>
		<h2>Require.js module</h2>
        <code>define( ["geometry","material","renderer","scene"],</code></br>
        <code>&nbsp;&nbsp;function ( geom, mat, renderer, scene ) {</code></br>
        <code>&nbsp;&nbsp;&nbsp;&nbsp;var app = {</code></br>
        <code>&nbsp;&nbsp;&nbsp;&nbsp;init: function () {</code></br>
        <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.mesh = new THREE.Mesh(geom.box, mat.ice);</code></br>
        <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.mesh.position.x = 20;</code></br>
        <code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scene.add( app.mesh );</code></br>
        <code>...</code></br>
	</div></section>
    <section class="slide"><div>
        <h2>Tools</h2>
        <ul>
            <li>Frontend</li>
            <ul>
                <li>THREE.js, JavaScript, <strong>Require.js, WebGL</strong></li>
            </ul>
            <li>Data processing</li>
            <ul>
                <li>Python, QGIS, GDAL</li>
            </ul>
            <li>Backend</li>
            <ul>
                <li><strong>Go (web server), PostGIS, Postgres</strong></li>
            </ul>
        </ul>
    </div></section>
    <section class="slide"><div>
        <h2>There's no debugger on the GPU!</h2>
        <ul>
            <li>State of WebGL tooling poor, relative to JavaScript</li>
            <li>Development really painful, typo takes 10 seconds to surface</li>
            <li>Solution: command line tool for validating GLSL</li>
        </ul>
        <p><a href="https://github.com/felixpalmer/glsl-validator">https://github.com/felixpalmer/glsl-validator</a></p>
    </div></section>
    <section class="slide"><div>
        <h2>OSS &amp; blogging</h2>
        <ul>
            <li>Great way to focus on a specific problem</li>
            <li>Feedback useful to improve code/design</li>
            <li>Motivation, when working on a unreleased project</li>
        </ul>
    </div></section>
	<section class="slide cover shout"><div>
		<h2>LOD terrain</h2>
		<img src="pictures/lod-terrain.jpg" alt="">
	</div></section>
    <section class="slide"><div>
        <h2>Innovating by elimination</h2>
        <ul>
            <li>As an individual, lack resources to compete against incumbents</li>
            <li>Look at what is being done and avoid duplicating it</li>
            <li>Embrace restrictions</li>
            <li>Better to have something innovative, but possibly useless, than useful, but already done</li>
        </ul>
    </div></section>
    <section class="slide cover"><div>
        <h2>No imagery? No problem</h2>
        <ul>
            <li>Do not use HD satellite photography</li>
            <li>Instead, generate terrains based on knowledge of locations</li>
        </ul>
		<img src="pictures/terra2.jpg" alt="">
    </div></section>
	<section class="slide cover" id="Data"><div>
		<h2>Data sources</h2>
		<ul>
			<li>Satellite imagery</li>
			<li>Elevation data</li>
			<li>Land cover data</li>
		</ul>
        <img class="right" src="pictures/data_sources.png" alt="">
        <p class="note">Data courtesy of:</p>
        <p class="note">NASA / ESA (GLOBCOVER)</p>
	</div></section>
    <section class="slide"><div>
        <h2>Giving up on the framework</h2>
        <ul>
            <li>Great for learning, but just too broad</li>
            <li>Lack of good data to make things work</li>
            <li>Unclear if any use cases, except...</li>
        </ul>
    </div></section>
    <section class="slide cover"><div>
        <h2>3D piste map</h2>
        <ul>
            <li>Dramatic terrain, 3D really shines</li>
            <li>Alpine landscapes reasonably simple</li>
            <li>"Just" snow and rock</li>
        </ul>
		<img src="pictures/la-plagne3.jpg" alt="">
    </div></section>
    <section class="slide shout cover"><div>
        <h2 class="dark">DEMO</h2>
		<img src="pictures/demo3.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>Experimentation</h2>
        <ul>
            <li>Engine too complex to tweak in code</li>
            <li>No longer just a programming problem</li>
            <li>Expose parameters using <a href="https://code.google.com/p/dat-gui/">DAT GUI</a></li>
        </ul>
        <img class="right" src="pictures/dat_gui.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>Transitioning to a product</h2>
        <ul>
            <li>Adding pistes</li>
            <li>Simplify camera controls</li>
            <li>Build chrome around engine (React.js)</li>
        </ul>
		<img class="small" src="pictures/piste.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>Tools</h2>
        <ul>
            <li>Frontend</li>
            <ul>
                <li>THREE.js, JavaScript, Require.js, WebGL, <strong>DAT GUI, React.js</strong></li>
            </ul>
            <li>Data processing</li>
            <ul>
                <li>Python, QGIS, GDAL</li>
            </ul>
            <li>Backend</li>
            <ul>
                <li><strong>what backend?</strong></li>
            </ul>
        </ul>
    </div></section>
    <section class="slide"><div>
        <h2>JavaScript is pretty fast</h2>
        <ul>
            <li>How to display labels?</li>
            <li>Need to raycast through terrain</li>
            <li>Efficiently handling DOM interactions using React.js</li>
        </ul>
        <img class="bottom" src="pictures/piste3.jpg" alt="">
    </div></section>
    <section class="slide"><div>
        <h2>Scaling</h2>
        <ul>
            <li>All work done on client, entire site is just static files</li>
            <li>Automate all data processing, do not want to do manual data entry!</li>
            <li>Scalabilty more or less comes for free, just need to host on scalable platform, e.g. S3</li>
            <li>Leverage cloud for computation</li>
        </ul>
    </div></section>
    <section class="slide"><div>
        <h2>Launching</h2>
        <ul>
            <li>Many, many bugs!</li>
            <li>Device/OS/browser specific quirks</li>
            <li>Terrible load time</li>
            <li>UX issues (3D is hard)</li>
            <li>Bit by bit, fix and improve</li>
        </ul>
        <img class="right" src="pictures/ipad.jpg" alt="">
    </div></section>
    <section class="slide cover"><div>
        <h2>Takeaways</h2>
        <ul>
            <li>Work on something you find interesting</li>
            <li>Never stop learning from others</li>
            <li>Break out difficult problems and blog about them</li>
            <li>Don't be afraid to do something new, even if value is unclear</li>
        </ul>
		<img src="pictures/piste2.jpg" alt="">
    </div></section>
	<script src="shower/shower.min.js"></script>
</body>
</html>
